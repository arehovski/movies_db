{% load static %}
{% load navigation_bar %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Movies DB</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
</head>
<body>
<div class="container">
    <div class="row mt-3 mb-3 header" style="background-color: gray">
        {% block header %}
            <div class="col-3 m-2 pt-3 pb-3" style="background-color: goldenrod">
                <a href="{% url 'home_page' %}">MOVIES DATABASE</a>
            </div>
            <div class="col-6 search">
                <form method="get">
                    {% csrf_token %}

                </form>
            </div>
            <div class="col-3 login" style="background-color: #0c5460">

            </div>
        {% endblock %}
    </div>
    <div class="row mb-2 mt-2 rounded">
        {% navigation_bar %}
        <div class="col-9 movie-list" style="background-color: #3d4d5e">
            <hr/>
            {% for movie in movies %}
                <div class="row">
                    <div class="col-3">
                        <img class="movie-list-poster img-fluid rounded" height="180" width="120"
                             src="{{ movie.image.url }}" alt="movie-poster">
                    </div>
                    <div class="col-7">
                        <div>{{ movie.title }}</div>
                        {% if movie.title_en %}
                            <div>{{ movie.title_en }}</div>
                        {% endif %}
                        <div>
                            <p><a href="{% url 'year_view' year=movie.year %}">{{ movie.year }}</a></p>
                            <span class="movie-genres" >
                                {% for genre in movie.genre.all %}
                                    <a href="{% url 'genre_view' genre=genre %}">{{ genre }}</a>{% if not forloop.last %},{% endif %}
                                {% endfor %}
                            </span>

                            <span class="movie-countries pl-1">
                                {% for country in movie.country.all %}
                                     <a href="{% url 'country_view' country=country %}">{{ country }}</a>{% if not forloop.last %},{% endif %}
                                {% endfor %}
                            </span>

                        </div>
                    </div>
                    <div class="col-2 rating">
                        <p>Рейтинг кинопоиска {{ movie.rating_kp }}</p>
                        {% if movie.rating_imdb %}
                            <p>Рейтинг IMDB {{ movie.rating_imdb }}</p>
                        {% endif %}
                    </div>
                </div>
                <hr/>
            {% endfor %}

            {% block pagination %}
                {% if movies %}
                    <div class="row">
                        <div class="col-4">
                            {% if movies.has_previous %}
                                <a href="?page={{ movies.previous_page_number }}">&laquo; previous</a>
                            {% endif %}
                        </div>
                        <div class="col-4 text-center">
                            {% for i in movies.paginator.page_range %}
                                {% ifequal i movies.number %}
                                    <a href="?page={{ i }}">{{ i }}</a>
                                {% endifequal %}
                            {% endfor %}
                        </div>
                        <div class="col-4 text-right">
                            {% if movies.has_next %}
                                <a href="?page={{ movies.next_page_number }}">next &raquo;</a>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            {% endblock %}
        </div>
    </div>
</div>

<script src="{% static "js/bootstrap.min.js" %}"></script>
</body>
</html>